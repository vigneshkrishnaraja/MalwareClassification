function [ A, Y, eigen_values, X_cov ] = PCA_transformation( X, N )
%Syntax: [ A, Y, eigen_values ] = PCA_transformation( X, N )
%  
% This function returns the PCA transformed features, transformation matrix
% and the corresponding eigen values
% Required Input Arguments: X - Train images/Dataset
%                           N - Number of PCA features
%
% Output Arguments: A - Transformation Matrix
%                   Y - Train images/Dataset after PCA transformation
%                   eigen_values - Values for upto 'N' features

% Finding the covariance matrix
X_cov = cov(X);

% Finding the eigen vector and eigen values of X_cov
[eigen_vector,eigen_values] = eig(X_cov);

% Extracting the eigen values
eigen_values = diag(eigen_values);

% Sorting the eigen_values in descending order and remembering the indices
[~,I] = sort(eigen_values,'descend');

% Selecting the top N features
A = eigen_vector(:,I(1:N));

% Transforming X using transformation matrix
Y = X * A;

% Selecting the top N eigen values
eigen_values = eigen_values(I(1:N)); 

end

